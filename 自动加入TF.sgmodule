#!name=自动[加入/监控]TestFlight
#!desc=1、自动加入TF使用前先获取账号令牌和填写应用ID[自己手动添加主机名testflight.apple.com]，一旦有新的名额即刻加入；2、监控TF位置不需要令牌也无需MITM
#!author=奶思[https://github.com/fmz200], DecoAri[https://github.com/DecoAri], xream[https://github.com/xream]
#!icon=https://raw.githubusercontent.com/fmz200/wool_scripts/main/icons/apps/testflight.png
#!openUrl=https://apps.apple.com/app/id899247664
#!tag=定时任务
#!loon_version=3.2.4(787)
#!homepage=https://github.com/fmz200/wool_scripts
#!raw-url=https://github.com/fmz200/wool_scripts/raw/main/Loon/plugin/Auto_Join_TF.plugin
#!tg-group=https://t.me/lanjieguanggao
#!date=2025-09-21 01:17:08

#!arguments=CaptureAccountToken:"false",RunTask:"false",RunMonitor:"true",TaskCron:"0 0/3 * * * ?",TaskMonitor:"0 * * * * ?",AppID:"请输入 TestFlight 应用 ID"

[Script]
获取账号令牌 = type=http-request, pattern=^https?:\/\/testflight\.apple\.com\/v3\/accounts\/.*\/apps$, script-path=https://raw.githubusercontent.com/fmz200/wool_scripts/main/Scripts/TestFlight/AutoJoinTFKeys.js

# 应用ID捕获（可选） — 如果脚本里支持使用 AppID 参数的话
# http-request ^https?:\/\/testflight\.apple\.com\/join\/(.*) script-path = https://raw.githubusercontent.com/fmz200/wool_scripts/main/Scripts/TestFlight/AutoJoinTFKeys.js, tag = 应用ID捕获(可能抓不到), enable = {CaptureAppID}

自动加入TF = type=cron, cronexp={{{TaskCron}}}, script-path=https://raw.githubusercontent.com/fmz200/wool_scripts/main/Scripts/TestFlight/AutoJoinTF.js, timeout=600, argument=AppID={{{AppID}}}

监控TF位置 = type=cron, cronexp={{{TaskMonitor}}}, script-path=https://raw.githubusercontent.com/fmz200/wool_scripts/main/Scripts/TestFlight/AutoMonitorTF.js, timeout=30, argument=AppID={{{AppID}}}
